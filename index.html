<!doctype html>
<html prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
    <title>æ¸¬è©¦ç¶²é </title>
    <link rel="icon" href="https://raw.githubusercontent.com/rushiaismywaifu/rushiaismywaifu.github.io/main/favicon.ico" type="image/x-icon">
    <meta property="og:title" content="Rushiaæˆ‘å©†">
    <meta property="og:description" content="é›–ç„¶å¥¹æ­»ã„Œ">
    <meta property="og:url" content="https://rushiaismywaifu.github.io">
    <meta property="og:image" content="https://raw.githubusercontent.com/rushiaismywaifu/rushiaismywaifu.github.io/main/image.png">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Rushia My Beloved">
    <style>
      .bili-short-url-box {
        margin: 20px 0;
        padding: 20px;
        border: 2px solid #00a1d6;
        border-radius: 10px;
        background: linear-gradient(135deg, #f0f8ff, #e8f4fd);
        max-width: 620px;
        font-family: Arial, "Microsoft JhengHei", sans-serif;
      }
      .bili-short-url-box h3 {
        margin: 0 0 6px 0;
        color: #00a1d6;
      }
      .bili-short-url-box .desc {
        margin: 0 0 12px 0;
        color: #555;
        font-size: 14px;
      }
      .bili-short-url-box .input-row {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .bili-short-url-box input[type="text"] {
        flex: 1;
        min-width: 200px;
        padding: 10px 12px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 14px;
        outline: none;
        transition: border-color .3s;
      }
      .bili-short-url-box input[type="text"]:focus {
        border-color: #00a1d6;
      }
      .gen-btn {
        padding: 10px 20px;
        background: #00a1d6;
        color: #fff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: background .3s;
        white-space: nowrap;
      }
      .gen-btn:hover { background: #0087b3; }
      .gen-btn:disabled { background: #aaa; cursor: not-allowed; }
      #shortUrlResult {
        display: none;
        margin-top: 12px;
        padding: 12px;
        background: #fff;
        border-radius: 6px;
        border: 1px solid #ddd;
        word-break: break-all;
        line-height: 1.7;
        font-size: 14px;
      }
      #shortUrlResult a {
        color: #00a1d6;
        font-weight: bold;
        text-decoration: none;
      }
      #shortUrlResult a:hover { text-decoration: underline; }
      .copy-btn {
        padding: 4px 12px;
        background: #fb7299;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
        margin-left: 8px;
        transition: background .3s;
      }
      .copy-btn:hover { background: #e0527a; }
    </style>
  </head>
  <body>
    <p>&nbsp;å—¨ï¼Œ <u><em><strong>test</strong></em></u>&nbsp; <s>Hello world!</s></p>
    <p style="text-align:center">x <sup>2</sup>+2x+1=0 </p>
    <p>å·¦é‚Š</p>
    <hr />
    <p style="text-align:right">å³é‚Š</p>
    <p><input name="æˆ‘æ˜¯æŒ‰éˆ•" type="radio" value="YES" />YES </p>
    <p><input maxlength="10" name="æ–‡å­—" type="email" value="0" /></p>
    <a href="https://rushiaismywaifu.github.io/project-1" target="_blank">å¾€project-1</a><br />
    <a href="/PageTest" target="_blank">å¾€PageTest</a><br />
    <a href="/aboutme" target="_blank">å¾€aboutme</a><br />
    <a href="https://raw.githubusercontent.com/rushiaismywaifu/PageTest/gh-pages/ayame.mp3">ayame</a>
    <audio src="https://raw.githubusercontent.com/rushiaismywaifu/PageTest/gh-pages/ayame.mp3" controls></audio>
    <p><select multiple="true" name="æ¬„ä½">
        <option value="50">abc</option>
        <option value="0">def</option>
        <option value="-5">ghi</option>
      </select></p>
    <p><input name="æŒ‰éˆ•å—" type="button" value="20" /></p>

    <hr />

    <!-- ===== Bilibili çŸ­ç¶²å€ç”¢ç”Ÿå™¨ ===== -->
    <div class="bili-short-url-box">
      <h3>ğŸ”— Bilibili çŸ­ç¶²å€ç”¢ç”Ÿå™¨</h3>
      <p class="desc">è¼¸å…¥ä»»æ„ Bilibili ç«™å…§ç¶²å€ï¼Œç”¢ç”Ÿ b23.tv çŸ­ç¶²å€</p>
      <div class="input-row">
        <input type="text" id="biliUrlInput"
               placeholder="ä¾‹ï¼šhttps://www.bilibili.com/video/BV1GJ411x7h7"
               onkeydown="if(event.key==='Enter')generateShortUrl();" />
        <button class="gen-btn" id="genBtn" onclick="generateShortUrl()">ç”¢ç”ŸçŸ­ç¶²å€</button>
      </div>
      <div id="shortUrlResult"></div>
    </div>
    <!-- ===== çµæŸ ===== -->

    <p><img alt="" src="https://raw.githubusercontent.com/rushiaismywaifu/rushiaismywaifu.github.io/main/d.png" style="float:left; height:1667px; width:2277px" /></p>
    <p style="text-align:right">&nbsp;</p>

    <script>
    /*
     * â˜…â˜…â˜… æŠŠé€™è£¡æ›æˆä½ è‡ªå·±éƒ¨ç½²çš„ Cloudflare Worker ç¶²å€ â˜…â˜…â˜…
     */
    var WORKER_URL = 'https://soft-boat-f648.csgtung88.workers.dev';

    async function generateShortUrl() {
      var input  = document.getElementById('biliUrlInput');
      var result = document.getElementById('shortUrlResult');
      var btn    = document.getElementById('genBtn');
      var url    = input.value.trim();

      result.style.display = 'block';

      /* åŸºæœ¬é©—è­‰ */
      if (!url) {
        result.innerHTML = '<span style="color:#e74c3c">âš ï¸ è«‹è¼¸å…¥ Bilibili ç¶²å€</span>';
        return;
      }
      if (!/^https?:\/\//i.test(url)) url = 'https://' + url;
      if (!/bilibili\.com/i.test(url)) {
        result.innerHTML = '<span style="color:#e74c3c">âš ï¸ ç¶²å€åŸŸåå¿…é ˆç‚º *.bilibili.com</span>';
        return;
      }

      /* è¼‰å…¥ç‹€æ…‹ */
      btn.disabled = true;
      btn.textContent = 'è™•ç†ä¸­â€¦';
      result.innerHTML = '<span style="color:#666">â³ ç”¢ç”Ÿä¸­ï¼Œè«‹ç¨å€™â€¦</span>';

      /* çµ„è£ POST body */
      var params = new URLSearchParams({
        platform:      'unix',
        share_channel: 'COPY',
        share_id:      'public.webview.0.0.pv',
        share_mode:    '4',
        oid:           url,
        buvid:         'qwq',
        build:         '6114514'
      });

      try {
        var resp = await fetch(WORKER_URL, {
          method:  'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body:    params.toString()
        });

        var data = await resp.json();

        btn.disabled = false;
        btn.textContent = 'ç”¢ç”ŸçŸ­ç¶²å€';

        if (data.code === 0 && data.data && data.data.content) {
          var content = data.data.content;
          var match   = content.match(/(https?:\/\/b23\.tv\/\S+)/);

          if (match) {
            var short = match[1];
            result.innerHTML =
              'âœ… çŸ­ç¶²å€ï¼š<a href="' + short + '" target="_blank">' + short + '</a>' +
              ' <button class="copy-btn" onclick="copyText(\'' + short + '\',this)">ğŸ“‹ è¤‡è£½</button>' +
              '<br><small style="color:#888">ğŸ“ ' + escapeHtml(content) + '</small>';
          } else {
            result.innerHTML = 'âœ… å›å‚³å…§å®¹ï¼š' + escapeHtml(content);
          }
        } else {
          result.innerHTML =
            '<span style="color:#e74c3c">âŒ ç”¢ç”Ÿå¤±æ•—ï¼š' +
            escapeHtml(data.message || JSON.stringify(data)) + '</span>';
        }

      } catch (e) {
        btn.disabled = false;
        btn.textContent = 'ç”¢ç”ŸçŸ­ç¶²å€';
        result.innerHTML =
          '<span style="color:#e74c3c">âŒ ç¶²è·¯éŒ¯èª¤ï¼š' + escapeHtml(e.message) +
          '<br>è«‹ç¢ºèª Worker ç¶²å€æ˜¯å¦æ­£ç¢º</span>';
      }
    }

    function copyText(text, btnEl) {
      navigator.clipboard.writeText(text).then(function () {
        btnEl.textContent = 'âœ… å·²è¤‡è£½';
        setTimeout(function () { btnEl.textContent = 'ğŸ“‹ è¤‡è£½'; }, 2000);
      }).catch(function () {
        var ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        btnEl.textContent = 'âœ… å·²è¤‡è£½';
        setTimeout(function () { btnEl.textContent = 'ğŸ“‹ è¤‡è£½'; }, 2000);
      });
    }

    function escapeHtml(str) {
      var d = document.createElement('div');
      d.appendChild(document.createTextNode(str));
      return d.innerHTML;
    }
    </script>
  </body>
</html>
